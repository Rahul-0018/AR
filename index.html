<!DOCTYPE html>
<html>
  <head>
    <title>Markerless AR with Logs</title>
    <script src="https://aframe.io/releases/1.4.2/aframe.min.js"></script>
    <style>
      body { margin: 0; overflow: hidden; }
      #logBox {
        position: fixed;
        top: 10px;
        left: 10px;
        background: rgba(0,0,0,0.7);
        color: #0f0;
        padding: 10px;
        font-family: monospace;
        font-size: 14px;
        max-width: 90%;
        max-height: 50%;
        overflow-y: auto;
        z-index: 9999;
        border-radius: 8px;
      }
    </style>
  </head>
  <body>
    <div id="logBox">ðŸ“‹ Logs:<br></div>

    <a-scene
      embedded
      renderer="colorManagement: true, physicallyCorrectLights"
      vr-mode-ui="enabled: false"
      xr-mode-ui="enabled: true"
      webxr="optionalFeatures: hit-test, local-floor, bounded-floor">

      <!-- Camera -->
      <a-entity camera look-controls></a-entity>

      <!-- Astronaut model -->
      <a-entity id="astro"
        gltf-model="https://cdn.jsdelivr.net/gh/KhronosGroup/glTF-Sample-Models/2.0/Astronaut/glTF-Binary/Astronaut.glb"
        scale="0.2 0.2 0.2"
        visible="false">
      </a-entity>
    </a-scene>

    <script>
      const logBox = document.getElementById("logBox");
      function addLog(msg) {
        console.log(msg); // Also in browser console
        logBox.innerHTML += msg + "<br>";
        logBox.scrollTop = logBox.scrollHeight;
      }

      const sceneEl = document.querySelector("a-scene");
      const astro = document.getElementById("astro");

      // Log app start
      addLog("ðŸš€ App started, waiting for AR session...");

      // AR session start
      sceneEl.addEventListener("enter-vr", () => {
        if (sceneEl.xrSession) {
          addLog("âœ… AR session started");
          astro.setAttribute("position", "0 0 -1"); // 1m in front
          astro.setAttribute("visible", "true");
          addLog("ðŸ‘¨â€ðŸš€ Astronaut placed 1m in front of camera");
        }
      });

      // Model events
      astro.addEventListener("model-loaded", () => addLog("âœ… Model loaded!"));
      astro.addEventListener("model-error", e => addLog("âŒ Model failed: " + JSON.stringify(e.detail)));

      // User tap (optional)
      window.addEventListener("click", () => {
        if (astro.getAttribute("visible") === "true") {
          const pos = astro.getAttribute("position");
          addLog("ðŸ‘† Screen tapped. Astronaut currently at: " + JSON.stringify(pos));
        } else {
          addLog("ðŸ‘† Screen tapped but astronaut not visible yet.");
        }
      });
    </script>
  </body>
</html>
